# 贡献代码

<cite>
**本文档引用的文件**  
- [README.md](file://README.md)
- [package.json](file://package.json)
- [Cargo.toml](file://src-tauri/Cargo.toml)
- [vite.config.ts](file://vite.config.ts)
- [tsconfig.json](file://tsconfig.json)
- [tauri.conf.json](file://src-tauri/tauri.conf.json)
- [index.tsx](file://src/index.tsx)
- [App.tsx](file://src/App.tsx)
- [main.rs](file://src-tauri/src/main.rs)
- [lib.rs](file://src-tauri/src/lib.rs)
- [error.rs](file://src-tauri/src/error.rs)
</cite>

## 目录
1. [简介](#简介)
2. [开发环境配置](#开发环境配置)
3. [代码提交流程](#代码提交流程)
4. [代码风格规范](#代码风格规范)
5. [依赖管理](#依赖管理)
6. [测试与代码质量](#测试与代码质量)
7. [Pull Request 审查流程](#pull-request-审查流程)

## 简介

devkimi 是一个基于 Tauri 和 SolidJS 构建的多功能开发者工具集，旨在为开发者提供一系列常用的开发辅助功能。项目采用 TypeScript 和 Rust 双语言架构，前端使用 SolidJS 框架，后端通过 Tauri 提供系统级能力。本贡献指南旨在为开发者提供完整的代码贡献指导，涵盖环境配置、代码规范、提交流程和审查标准。

**本节来源**  
- [README.md](file://README.md#L1-L122)

## 开发环境配置

要开始贡献代码，首先需要正确配置开发环境。devkimi 项目依赖 Node.js、Rust 和 pnpm 包管理器。

### 环境要求
- Node.js（推荐使用 LTS 版本）
- Rust（推荐使用最新稳定版）
- pnpm 包管理器

### 安装依赖
```bash
pnpm install
```

### 启动开发模式
```bash
# 启动开发服务器
pnpm dev

# 或直接使用 Tauri 启动桌面应用
pnpm tauri dev
```

### 构建应用
```bash
# 构建前端资源
pnpm build

# 构建桌面应用
pnpm tauri build
```

项目使用 Vite 作为构建工具，配置文件为 `vite.config.ts`，前端框架为 SolidJS，样式系统采用 TailwindCSS 与 DaisyUI。Tauri 配置文件 `tauri.conf.json` 定义了应用的基本属性和构建参数。

**本节来源**  
- [README.md](file://README.md#L58-L88)
- [vite.config.ts](file://vite.config.ts#L1-L15)
- [tauri.conf.json](file://src-tauri/tauri.conf.json#L1-L46)

## 代码提交流程

devkimi 项目遵循标准的 Git 分支管理策略和提交规范，确保代码库的整洁和可维护性。

### 分支管理策略
- `main` 分支：主分支，仅用于发布版本
- `dev` 分支：开发分支，所有功能开发基于此分支
- 功能分支：从 `dev` 分支创建，命名格式为 `feature/功能描述` 或 `fix/问题描述`

### 提交信息规范
提交信息应遵循以下格式：
```
<类型>: <简短描述>

<详细描述>

<关联的 Issue>
```

支持的提交类型包括：
- `feat`：新增功能
- `fix`：修复缺陷
- `docs`：文档更新
- `style`：代码格式调整
- `refactor`：代码重构
- `test`：测试相关
- `chore`：构建或辅助工具变更

**本节来源**  
- [README.md](file://README.md#L120-L122)

## 代码风格规范

devkimi 项目对 TypeScript 和 Rust 代码均有严格的风格要求，确保代码的一致性和可读性。

### TypeScript 编码规范
- 使用 Prettier 进行代码格式化
- 遵循 ESLint 的严格模式
- 类型定义优先使用接口（interface）
- 变量和函数命名采用驼峰式（camelCase）
- 组件文件使用 PascalCase 命名
- 文件路径使用 `@/*` 别名引用 src 目录

### Rust 编码规范
- 使用 rustfmt 进行代码格式化
- 遵循 Rust 官方风格指南
- 模块组织清晰，功能相关代码放在同一模块
- 错误处理使用 `thiserror` 宏定义
- 函数和变量命名采用 snake_case
- 类型和结构体命名采用 PascalCase

### 注释标准
- 所有公共 API 必须有文档注释
- 复杂逻辑需要添加行内注释
- TypeScript 文件使用 JSDoc 风格
- Rust 文件使用标准文档注释

**本节来源**  
- [tsconfig.json](file://tsconfig.json#L1-L25)
- [Cargo.toml](file://src-tauri/Cargo.toml#L1-L69)
- [App.tsx](file://src/App.tsx#L1-L47)
- [lib.rs](file://src-tauri/src/lib.rs#L1-L57)

## 依赖管理

devkimi 项目采用分层依赖管理策略，前端和后端分别使用不同的包管理工具。

### 前端依赖管理
- 包管理器：pnpm
- 依赖配置：`package.json`
- 主要依赖包括：
  - SolidJS 前端框架
  - Tauri API 插件
  - TailwindCSS 样式系统
  - Monaco Editor 代码编辑器

### 后端依赖管理
- 包管理器：Cargo
- 依赖配置：`Cargo.toml`
- 主要依赖包括：
  - Tauri 核心库
  - serde 序列化框架
  - 加密相关库（rsa, sha2, md-5）
  - 文件处理库（flate2, image）
  - 格式解析库（serde_json, serde_yaml, quick-xml）

### 添加新依赖
- 前端依赖：使用 `pnpm add <package>` 命令
- 后端依赖：在 `Cargo.toml` 中添加依赖项
- 所有依赖更新需在提交信息中说明原因

**本节来源**  
- [package.json](file://package.json#L1-L43)
- [Cargo.toml](file://src-tauri/Cargo.toml#L1-L69)

## 测试与代码质量

devkimi 项目高度重视代码质量和测试覆盖率，采用多种工具确保代码的稳定性和可靠性。

### 代码质量检查工具
- TypeScript：通过 `tsc` 进行类型检查
- Rust：通过 `cargo clippy` 进行代码风格检查
- 格式化：Prettier（TypeScript）和 rustfmt（Rust）
- 静态分析：`cargo check` 和 ESLint

### 测试要求
- 所有新功能必须包含单元测试
- 核心功能需要集成测试
- 测试覆盖率应保持在 80% 以上
- 测试文件与源文件同目录，命名以 `_test` 结尾

### 构建验证
- CI/CD 流水线自动运行测试
- 代码格式检查作为提交前钩子
- 类型检查在构建阶段执行
- Rust 代码在 release 模式下进行优化构建

**本节来源**  
- [Cargo.toml](file://src-tauri/Cargo.toml#L60-L69)
- [tsconfig.json](file://tsconfig.json#L15-L18)

## Pull Request 审查流程

devkimi 项目采用严格的 Pull Request 审查流程，确保代码质量和项目稳定性。

### PR 创建要求
- 必须基于最新的 `dev` 分支创建
- 提交信息符合规范
- 包含适当的测试用例
- 更新相关文档
- 关联对应的 Issue

### 审查标准
- 代码功能正确性
- 是否符合编码规范
- 测试覆盖率是否达标
- 文档是否完整
- 是否影响性能
- 错误处理是否完善

### 合并条件
- 至少一名核心维护者批准
- 所有 CI 检查通过
- 代码风格检查通过
- 测试用例全部通过
- 文档更新完成

PR 将在满足所有条件后由维护者合并到 `dev` 分支，定期从 `dev` 分支向 `main` 分支进行版本发布。

**本节来源**  
- [README.md](file://README.md#L120-L122)
- [Cargo.toml](file://src-tauri/Cargo.toml#L60-L69)
- [tsconfig.json](file://tsconfig.json#L15-L18)